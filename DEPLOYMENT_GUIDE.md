# ðŸš€ AIpply API Deployment Guide

This guide provides step-by-step instructions to deploy your AIpply API and make it functional for users.

## ðŸ“‹ Prerequisites

Before deploying, ensure you have:
- âœ… OpenAI API key
- âœ… Git repository (GitHub/GitLab)
- âœ… Domain name (optional but recommended)
- âœ… Basic understanding of cloud platforms

## ðŸŽ¯ Quick Start Deployment Options

### Option 1: Heroku (Easiest - 10 minutes)

**Step 1: Prepare your repository**
```bash
# Ensure your code is in a Git repository
git add .
git commit -m "Ready for deployment"
git push origin main
```

**Step 2: Deploy to Heroku**
```bash
# Install Heroku CLI from https://devcenter.heroku.com/articles/heroku-cli
heroku login

# Create a new Heroku app
heroku create aipply-api-yourname

# Add PostgreSQL database
heroku addons:create heroku-postgresql:hobby-dev

# Set environment variables
heroku config:set OPENAI_API_KEY=your_openai_key_here
heroku config:set ENVIRONMENT=production

# Deploy your app
git push heroku main

# Open your app
heroku open
```

**Step 3: Verify deployment**
- Visit your Heroku app URL
- Check API docs at: `https://your-app.herokuapp.com/docs`
- Test health endpoint: `https://your-app.herokuapp.com/api/health`

### Option 2: Railway (Modern - 5 minutes)

**Step 1: Connect to Railway**
1. Go to [Railway.app](https://railway.app)
2. Sign up with GitHub
3. Click "New Project" â†’ "Deploy from GitHub repo"
4. Select your AIpply repository

**Step 2: Configure Environment**
1. Add PostgreSQL database in Railway dashboard
2. Set environment variables:
   - `OPENAI_API_KEY`: Your OpenAI API key
   - `ENVIRONMENT`: production
   - `DATABASE_URL`: (auto-generated by Railway)

**Step 3: Deploy**
- Railway automatically deploys on every git push
- Your app will be available at a Railway-provided URL

### Option 3: DigitalOcean App Platform

**Step 1: Create App**
1. Go to DigitalOcean App Platform
2. Create new app from GitHub repository
3. Select your AIpply repository

**Step 2: Configure Services**
```yaml
# App spec (auto-generated)
name: aipply-api
services:
- name: web
  source_dir: /
  github:
    repo: your-username/aipply-api
    branch: main
  run_command: python main_enhanced.py
  environment_slug: python
  instance_count: 1
  instance_size_slug: basic-xxs
  envs:
  - key: OPENAI_API_KEY
    value: your_openai_key_here
  - key: ENVIRONMENT
    value: production
```

**Step 3: Add Database**
1. Add managed PostgreSQL database
2. Update `DATABASE_URL` environment variable

### Option 4: Docker Deployment (Most Control)

#### Local Docker Testing
```bash
# Test locally with Docker
docker-compose up -d

# Check if running
curl http://localhost:8000/api/health
```

#### VPS Deployment with Docker
```bash
# 1. Set up VPS (Ubuntu 20.04+)
ssh root@your-server-ip

# 2. Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# 3. Install Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# 4. Clone your repository
git clone https://github.com/your-username/aipply-api.git
cd aipply-api

# 5. Create environment file
cp env.example .env
nano .env  # Edit with your settings

# 6. Deploy
docker-compose up -d

# 7. Set up reverse proxy (Nginx)
sudo apt install nginx
# Configure nginx to proxy to localhost:8000
```

## ðŸ”§ Production Configuration

### Environment Variables Setup

Create a `.env` file with these variables:

```bash
# Required
OPENAI_API_KEY=your_openai_api_key_here
ENVIRONMENT=production

# Database (use PostgreSQL for production)
DATABASE_URL=postgresql://username:password@host:port/database

# Security
SECRET_KEY=your_random_secret_key_here
ALLOWED_ORIGINS=https://yourdomain.com

# Optional
REDIS_URL=redis://localhost:6379
LOG_LEVEL=INFO
```

### Database Setup

#### For PostgreSQL (Recommended):
```bash
# Create database
createdb aipply_production

# Set environment variable
export DATABASE_URL=postgresql://username:password@localhost:5432/aipply_production
```

#### For SQLite (Development only):
```bash
# Uses local file - not recommended for production
DATABASE_URL=sqlite:///./aipply.db
```

### SSL/HTTPS Setup

#### With Let's Encrypt (Free SSL):
```bash
# Install Certbot
sudo apt install certbot python3-certbot-nginx

# Get SSL certificate
sudo certbot --nginx -d yourdomain.com

# Auto-renewal
sudo crontab -e
# Add: 0 12 * * * /usr/bin/certbot renew --quiet
```

## ðŸš€ Testing Your Deployment

### Health Checks
```bash
# Test API health
curl https://your-domain.com/api/health

# Expected response:
# {"status": "healthy", "timestamp": "2024-01-01T12:00:00Z"}
```

### Functional Tests
```bash
# Test search endpoint
curl "https://your-domain.com/api/search?keyword=scholarship"

# Test AI chat
curl -X POST "https://your-domain.com/api/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "Find me scholarship opportunities"}'
```

### Frontend Testing
1. Visit your domain
2. Test the chat interface
3. Verify opportunity search works
4. Check if AI responses are working

## ðŸ”’ Security Checklist

- [ ] Set strong `SECRET_KEY`
- [ ] Configure `ALLOWED_ORIGINS` for CORS
- [ ] Use HTTPS (SSL certificate)
- [ ] Set up rate limiting
- [ ] Keep dependencies updated
- [ ] Monitor for security vulnerabilities
- [ ] Set up proper error handling

## ðŸ“Š Monitoring & Maintenance

### Health Monitoring
```bash
# Set up uptime monitoring with:
# - UptimeRobot
# - Pingdom
# - StatusCake
```

### Log Monitoring
```bash
# View application logs
heroku logs --tail  # For Heroku
docker-compose logs -f  # For Docker
```

### Performance Monitoring
- Monitor response times
- Check database performance
- Monitor memory usage
- Set up alerts for downtime

## ðŸ†˜ Troubleshooting

### Common Issues

**1. OpenAI API Key Error**
```bash
# Check if key is set correctly
echo $OPENAI_API_KEY
```

**2. Database Connection Issues**
```bash
# Test database connection
python -c "from startup_opps_api.database.database import get_db; print('DB OK')"
```

**3. Port Issues**
```bash
# Check if port 8000 is available
netstat -tulpn | grep :8000
```

**4. CORS Issues**
- Update `ALLOWED_ORIGINS` in environment variables
- Check CORS middleware configuration

### Getting Help

1. Check application logs
2. Verify environment variables
3. Test endpoints individually
4. Check database connectivity
5. Verify OpenAI API key

## ðŸŽ‰ Post-Deployment

### Launch Checklist
- [ ] All endpoints working
- [ ] Frontend accessible
- [ ] AI chat functional
- [ ] Database operations working
- [ ] SSL certificate active
- [ ] Monitoring configured
- [ ] Backup strategy in place

### User Onboarding
1. Share your API URL with users
2. Provide API documentation
3. Set up user feedback collection
4. Monitor usage patterns

---

## ðŸš€ Quick Commands Summary

```bash
# Local development
python main_enhanced.py

# Docker local testing
docker-compose up -d

# Heroku deployment
heroku create your-app-name
git push heroku main

# Railway deployment
# Just push to GitHub - auto-deploys!

# VPS deployment
git clone your-repo
docker-compose up -d
```

**Your AIpply API is now ready for users! ðŸŽ‰**
